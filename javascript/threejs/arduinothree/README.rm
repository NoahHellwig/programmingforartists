See code explained here:
https://docs.google.com/document/d/1oUJwGGeegPdA07wg_LmCkjIyuZRakAiObvKkDTB6r6g/edit
